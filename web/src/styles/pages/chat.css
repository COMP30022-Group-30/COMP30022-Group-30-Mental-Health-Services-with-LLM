/* --- Top banner (now NOT sticky) --- */
.anon-banner{
  position: static;                     /* was: sticky */
  display:flex; justify-content:space-between; align-items:center; gap:12px;
  padding:12px 16px;
  background: linear-gradient(180deg, var(--surface) 0%, var(--surface-alt) 100%);
  border:1px solid var(--grey-300);
  border-radius: var(--radius-lg);
  margin-bottom:16px;
}

/* --- Layout --- */
.chat-page{
  display:grid; grid-template-columns: 300px 1fr; gap:16px; align-items:stretch;
}
.chat-page.-collapsed{ grid-template-columns: 1fr; }

/* --- Sidebar --- */
.chat-sidebar{
  background:var(--surface); border:1px solid var(--grey-300); border-radius:var(--radius-lg);
  display:flex; flex-direction:column;
  min-height: calc(100vh - 220px);
}
.sidebar-head{ display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid var(--grey-300); }
.sidebar-body{ padding:12px 16px; overflow:auto; }
.hambtn{ position:sticky; top: 12px; left: 12px; width:36px; height:36px; border-radius:10px; border:1px solid var(--grey-300); background:var(--surface); }

/* --- Main --- */
.chat-main{
  position:relative; background:var(--surface); border:1px solid var(--grey-300); border-radius:var(--radius-lg);
  display:grid; grid-template-rows:auto 1fr auto;
  min-height: calc(100vh - 220px);
}
.chat-head{ display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid var(--grey-300); }
.chat-scroller{ overflow:auto; padding:16px; }

/* --- Transcript (NO grid to avoid stretch) --- */
.transcript{
  list-style:none; margin:0; padding:0;
  display:flex; flex-direction:column; gap:12px;   /* ← fixes giant bubbles */
}
.transcript > li{ align-self:flex-start; }         /* default left */
.transcript > li.user{ align-self:flex-end; }      /* user to the right */

/* --- Bubbles --- */
.msg{
  max-width: min(64ch, 85%);                       /* tighter, more readable */
  padding:10px 12px;
  border-radius:14px;
  animation:bubbleIn .18s ease-out;
  line-height:1.4;
}
.msg.assistant{ background:#fff; border:1px solid var(--grey-300); }
.msg.user{ background:var(--green-100); }
.msg-meta{ font-size:12px; color:var(--grey-600); margin-bottom:4px; }
.msg-text{ white-space:pre-wrap; word-break:break-word; } /* wrap nicely */

@keyframes bubbleIn{ from{transform:translateY(3px); opacity:0} to{transform:translateY(0); opacity:1} }

/* --- Composer full-width bar --- */
.composer-bar{ position:sticky; bottom:0; padding:12px 16px; border-top:1px solid var(--grey-300); background:var(--surface); }
.chat-input{ display:grid; grid-template-columns: 1fr auto; gap:10px; }
.chat-input textarea{
  width:100%; min-height:48px; padding:12px 14px;
  border:1px solid var(--grey-300); border-radius:var(--radius-lg); resize:none;
}

/* --- Typing + Jump --- */
.typing-row{ display:flex; margin-top:4px; }
.typing-bubble{ display:inline-flex; align-items:center; gap:6px; padding:.45rem .65rem; border-radius:999px; background:var(--offwhite-3); border:1px solid var(--grey-300); }
.typing-dot{ width:6px; height:6px; border-radius:50%; background:var(--brand); animation: typingDot 1.2s infinite; }
@keyframes typingDot{ 0%,60%,100%{transform:translateY(0); opacity:.6} 30%{transform:translateY(-3px); opacity:1} }
.jump-latest{ margin:0 auto; padding:6px 10px; border:1px solid var(--grey-300); border-radius:999px; background:var(--surface); }